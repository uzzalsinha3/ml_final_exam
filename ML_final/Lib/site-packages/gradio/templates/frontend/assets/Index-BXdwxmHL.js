import"./svelte/svelte_internal_flags_async.js";import*as e from"./svelte/svelte_internal_client.js";import"./i18n-BldJSFLV.js";import{G as ue}from"./utils.svelte-Ceck75cM.js";import{e as re,c as le,R as te,y as se,B as ce}from"./IconButtonWrapper-Cljb5D-5.js";import"./svelte/svelte_internal_flags_legacy.js";import{createEventDispatcher as de,tick as _e}from"./svelte/svelte_svelte.js";import{fly as pe}from"./svelte/svelte_transition.js";import{S as ge}from"./StreamingBar-b2qVLPYU.js";import{default as tt}from"./Example-Ctdnw0MA.js";import"./svelte/svelte_store.js";import"./index-Ds2meNS5.js";import"./svelte/svelte_animate.js";import"./svelte/svelte_attachments.js";import"./svelte/svelte_easing.js";import"./svelte/svelte_internal_flags_tracing.js";import"./svelte/svelte_internal_server.js";import"./svelte/svelte_legacy.js";import"./svelte/svelte_motion.js";import"./svelte/svelte_reactivity.js";import"./svelte/svelte_reactivity_window.js";import"./svelte/svelte_server.js";import"./svelte/svelte_events.js";import"./MarkdownCode-C2b9iIxl.js";import"./prism-python-CpYAgONt.js";var fe=e.from_html('<li data-testid="dropdown-option" role="option"><span>âœ“</span> </li>'),ve=e.from_html('<ul class="options svelte-1ou0lab" role="listbox"></ul>'),me=e.from_html('<div class="reference"></div> <!>',1);function ae(x,l){e.push(l,!1);let t=e.prop(l,"choices",12),s=e.prop(l,"filtered_indices",12),u=e.prop(l,"show_options",12,!1),c=e.prop(l,"disabled",12,!1),d=e.prop(l,"selected_indices",28,()=>[]),I=e.prop(l,"active_index",12,null),O=e.prop(l,"remember_scroll",12,!1),R=e.prop(l,"offset_from_top",12,0),g=e.prop(l,"from_top",12,!1),A=e.mutable_source(),m=e.mutable_source(),G=e.mutable_source(),f=e.mutable_source(),b=e.mutable_source(),o=e.mutable_source(),C=e.mutable_source(),N=e.mutable_source(),H=e.mutable_source(),p=e.mutable_source(),v=e.mutable_source(0);function U(){const{top:a,bottom:h}=e.get(b).getBoundingClientRect();g()?e.set(A,R()):e.set(A,a),e.set(m,e.get(p)-h)}let W=null;function J(){u()&&(W!==null&&clearTimeout(W),W=setTimeout(()=>{U(),W=null},10))}function S(){e.get(o)?.scrollTo?.(0,e.get(v))}const E=de();e.legacy_pre_effect(()=>(e.deep_read_state(u()),e.get(b),e.deep_read_state(O()),e.get(o),e.deep_read_state(d()),e.get(G),e.get(m),e.get(A),e.deep_read_state(g())),()=>{if(u()&&e.get(b)){if(O())S();else if(e.get(o)&&d().length>0){let h=e.get(o).querySelectorAll("li");for(const z of Array.from(h))if(z.getAttribute("data-index")===d()[0].toString()){e.get(o)?.scrollTo?.(0,z.offsetTop);break}}U();const a=e.get(b).parentElement?.getBoundingClientRect();e.set(G,a?.height||0),e.set(f,a?.width||0)}e.get(m)>e.get(A)||g()?(e.set(C,`${e.get(A)}px`),e.set(H,e.get(m)),e.set(N,null)):(e.set(N,`${e.get(m)+e.get(G)}px`),e.set(H,e.get(A)-e.get(G)),e.set(C,null))}),e.legacy_pre_effect_reset();var j={get choices(){return t()},set choices(a){t(a),e.flush()},get filtered_indices(){return s()},set filtered_indices(a){s(a),e.flush()},get show_options(){return u()},set show_options(a){u(a),e.flush()},get disabled(){return c()},set disabled(a){c(a),e.flush()},get selected_indices(){return d()},set selected_indices(a){d(a),e.flush()},get active_index(){return I()},set active_index(a){I(a),e.flush()},get remember_scroll(){return O()},set remember_scroll(a){O(a),e.flush()},get offset_from_top(){return R()},set offset_from_top(a){R(a),e.flush()},get from_top(){return g()},set from_top(a){g(a),e.flush()}};e.init();var K=me();e.event("scroll",e.window,J);var Q=e.first_child(K);e.bind_this(Q,a=>e.set(b,a),()=>e.get(b));var Z=e.sibling(Q,2);{var V=a=>{var h=ve();let z;e.each(h,5,s,e.index,(M,w)=>{var _=fe();let L,X;var Y=e.child(_);let y;var r=e.sibling(Y);e.reset(_),e.template_effect((i,k,q)=>{L=e.set_class(_,1,"item svelte-1ou0lab",null,L,i),e.set_attribute(_,"data-index",e.get(w)),e.set_attribute(_,"aria-label",(e.deep_read_state(t()),e.get(w),e.untrack(()=>t()[e.get(w)][0]))),e.set_attribute(_,"aria-selected",k),X=e.set_style(_,"",X,{width:e.get(f)+"px"}),y=e.set_class(Y,1,"inner-item svelte-1ou0lab",null,y,q),e.set_text(r,` ${e.deep_read_state(t()),e.get(w),e.untrack(()=>t()[e.get(w)][0])??""}`)},[()=>({selected:d().includes(e.get(w)),active:e.get(w)===I(),"bg-gray-100":e.get(w)===I(),"dark:bg-gray-600":e.get(w)===I()}),()=>(e.deep_read_state(d()),e.get(w),e.untrack(()=>d().includes(e.get(w)))),()=>({hide:!d().includes(e.get(w))})]),e.append(M,_)}),e.reset(h),e.bind_this(h,M=>e.set(o,M),()=>e.get(o)),e.template_effect(()=>z=e.set_style(h,"",z,{top:e.get(C),bottom:e.get(N),"max-height":`calc(${e.get(H)}px - var(--window-padding))`,width:e.get(f)+"px"})),e.transition(3,h,()=>pe,()=>({duration:200,y:5})),e.event("mousedown",h,e.preventDefault(M=>E("change",M))),e.event("scroll",h,M=>e.set(v,M.currentTarget.scrollTop)),e.append(a,h)};e.if(Z,a=>{u()&&!c()&&a(V)})}return e.bind_window_size("innerHeight",a=>e.set(p,a)),e.append(x,K),e.pop(j)}function he(x,l){return(x%l+l)%l}function ne(x,l){return x.reduce((t,s,u)=>((!l||s[0].toLowerCase().includes(l.toLowerCase()))&&t.push(u),t),[])}function oe(x,l,t){if(x.key==="Escape")return[!1,l];if((x.key==="ArrowDown"||x.key==="ArrowUp")&&t.length>0)if(l===null)l=x.key==="ArrowDown"?t[0]:t[t.length-1];else{const s=t.indexOf(l),u=x.key==="ArrowUp"?-1:1;l=t[he(s+u,t.length)]}return[!0,l]}var be=e.from_html('<div class="token-remove svelte-1dv2vbb" role="button" tabindex="0"><!></div>'),we=e.from_html('<div class="token svelte-1dv2vbb"><span class="svelte-1dv2vbb"><!></span> <!></div>'),ye=e.from_html('<div role="button" tabindex="0" class="token-remove remove-all svelte-1dv2vbb"><!></div>'),ke=e.from_html('<!> <span class="icon-wrap svelte-1dv2vbb"><!></span>',1),xe=e.from_html('<label><!> <!> <div class="wrap svelte-1dv2vbb"><div><!> <div class="secondary-wrap svelte-1dv2vbb"><input autocomplete="off"/> <!></div></div> <!></div></label>');function Ae(x,l){e.push(l,!0),e.rest_props(l,["$$slots","$$events","$$legacy"]);const t=l.gradio;let s,u=e.state(""),c=e.derived(()=>t.shared.label||"Multiselect"),d=e.derived(()=>t.props.buttons),I=e.derived(()=>t.props.choices.map(r=>r[0])),O=e.derived(()=>t.props.choices.map(r=>r[1])),R=e.derived(()=>!t.shared.interactive),g=e.state(!1),A=e.derived(()=>{const r=ne(t.props.choices,e.get(u));return[r,r.length>0&&!t.props.allow_custom_value?r[0]:null]}),m=e.derived(()=>e.to_array(e.get(A),2)),G=e.derived(()=>e.get(m)[0]),f=e.derived(()=>e.get(m)[1]);function b(){return t.props.value===void 0?[]:Array.isArray(t.props.value)?t.props.value.map(r=>{const i=e.get(O).indexOf(r);if(i!==-1)return i;if(t.props.allow_custom_value)return r}).filter(r=>r!==void 0):[]}let o=e.derived(b);function C(){t.props.allow_custom_value||e.set(u,""),t.props.allow_custom_value&&e.get(u)!==""&&(H(e.get(u)),e.set(u,"")),t.dispatch("blur"),e.set(g,!1),e.set(f,null)}function N(r){e.set(o,e.get(o).filter(i=>i!==r)),t.props.value=e.get(o).map(i=>typeof i=="number"?e.get(O)[i]:i),t.dispatch("input"),t.dispatch("select",{index:typeof r=="number"?r:-1,value:typeof r=="number"?e.get(O)[r]:r,selected:!1})}function H(r){(t.props.max_choices==null||e.get(o).length<t.props.max_choices)&&(e.get(o).push(r),t.dispatch("select",{index:typeof r=="number"?r:-1,value:typeof r=="number"?e.get(O)[r]:r,selected:!0})),e.get(o).length===t.props.max_choices&&(e.set(g,!1),e.set(f,null),s.blur()),t.props.value=e.get(o).map(i=>typeof i=="number"?e.get(O)[i]:i)}function p(r){const i=parseInt(r.detail.target.dataset.index);v(i)}function v(r){e.get(o).includes(r)?N(r):H(r),e.set(u,""),e.set(f,null),t.dispatch("input")}function U(r){e.set(o,[]),e.set(u,""),t.props.value=[],r.preventDefault()}function W(r){e.set(G,t.props.choices.map((i,k)=>k)),(t.props.max_choices===null||e.get(o).length<t.props.max_choices)&&e.set(g,!0),t.dispatch("focus"),e.set(g,!0)}function J(r){(i=>{var k=e.to_array(i,2);e.set(g,k[0],!0),e.set(f,k[1])})(oe(r,e.get(f),e.get(G))),r.key==="Enter"&&(e.get(f)!==null?v(e.get(f)):t.props.allow_custom_value&&(H(e.get(u)),e.set(u,""))),r.key==="Backspace"&&e.get(u)===""&&e.set(o,[...e.get(o).slice(0,-1)]),e.get(o).length===t.props.max_choices&&(e.set(g,!1),e.set(f,null))}let S=e.state(e.proxy(t.props.value));e.user_effect(()=>{e.get(S)!==t.props.value&&(e.set(S,t.props.value,!0),t.dispatch("change"))});function E(r){t.dispatch("custom_button_click",{id:r})}var j=xe();let K;var Q=e.child(j);{var Z=r=>{le(r,{get buttons(){return e.get(d)},on_custom_button_click:E})};e.if(Q,r=>{t.shared.show_label&&e.get(d)&&e.get(d).length>0&&r(Z)})}var V=e.sibling(Q,2);re(V,{get show_label(){return t.shared.show_label},get info(){return t.props.info},children:(r,i)=>{e.next();var k=e.text();e.template_effect(()=>e.set_text(k,e.get(c))),e.append(r,k)},$$slots:{default:!0}});var a=e.sibling(V,2),h=e.child(a);let z;var M=e.child(h);e.each(M,17,()=>e.get(o),e.index,(r,i)=>{var k=we(),q=e.child(k),n=e.child(q);{var D=T=>{var P=e.text();e.template_effect(()=>e.set_text(P,e.get(I)[e.get(i)])),e.append(T,P)},B=T=>{var P=e.text();e.template_effect(()=>e.set_text(P,e.get(i))),e.append(T,P)};e.if(n,T=>{typeof e.get(i)=="number"?T(D):T(B,!1)})}e.reset(q);var F=e.sibling(q,2);{var $=T=>{var P=be(),ie=e.child(P);te(ie),e.reset(P),e.template_effect(ee=>e.set_attribute(P,"title",ee),[()=>t.i18n("common.remove")+" "+e.get(i)]),e.event("click",P,e.preventDefault(()=>N(e.get(i)))),e.event("keydown",P,ee=>{ee.key==="Enter"&&N(e.get(i))}),e.append(T,P)};e.if(F,T=>{e.get(R)||T($)})}e.reset(k),e.append(r,k)});var w=e.sibling(M,2),_=e.child(w);e.remove_input_defaults(_);let L;e.bind_this(_,r=>s=r,()=>s);var X=e.sibling(_,2);{var Y=r=>{var i=ke(),k=e.first_child(i);{var q=B=>{var F=ye(),$=e.child(F);te($),e.reset(F),e.template_effect(T=>e.set_attribute(F,"title",T),[()=>t.i18n("common.clear")]),e.event("click",F,U),e.event("keydown",F,T=>{T.key==="Enter"&&U(T)}),e.append(B,F)};e.if(k,B=>{e.get(o).length>0&&B(q)})}var n=e.sibling(k,2),D=e.child(n);se(D),e.reset(n),e.append(r,i)};e.if(X,r=>{e.get(R)||r(Y)})}e.reset(w),e.reset(h);var y=e.sibling(h,2);ae(y,{get show_options(){return e.get(g)},get choices(){return t.props.choices},get filtered_indices(){return e.get(G)},get disabled(){return e.get(R)},get selected_indices(){return e.get(o)},get active_index(){return e.get(f)},remember_scroll:!0,$$events:{change:p}}),e.reset(a),e.reset(j),e.template_effect(r=>{K=e.set_class(j,1,"svelte-1dv2vbb",null,K,{container:t.shared.container}),z=e.set_class(h,1,"wrap-inner svelte-1dv2vbb",null,z,{show_options:e.get(g)}),L=e.set_class(_,1,"border-none svelte-1dv2vbb",null,L,r),_.disabled=e.get(R),_.readOnly=!t.props.filterable},[()=>({subdued:!e.get(I).includes(e.get(u))&&!t.props.allow_custom_value||e.get(o).length===t.props.max_choices})]),e.bind_value(_,()=>e.get(u),r=>e.set(u,r)),e.event("keydown",_,J),e.event("keyup",_,r=>{t.dispatch("key_up",{key:r.key,input_value:e.get(u)})}),e.event("blur",_,C),e.event("focus",_,W),e.append(x,j),e.pop()}var De=e.from_html('<div class="icon-wrap svelte-1xfsv4t"><!></div>'),Be=e.from_html('<div><!> <!> <div class="wrap svelte-1xfsv4t"><div><div class="secondary-wrap svelte-1xfsv4t"><input role="listbox" aria-controls="dropdown-options" autocomplete="off"/> <!></div></div> <!></div></div>');function Ee(x,l){e.push(l,!0);const t=typeof window<"u";let s=e.prop(l,"label",3,"Dropdown"),u=e.prop(l,"info",3,void 0),c=e.prop(l,"value",15),d=e.prop(l,"choices",19,()=>[]),I=e.prop(l,"interactive",3,!0),O=e.prop(l,"show_label",3,!0),R=e.prop(l,"container",3,!0),g=e.prop(l,"allow_custom_value",3,!1),A=e.prop(l,"filterable",3,!0),m=e.prop(l,"buttons",3,null),G=e.prop(l,"on_custom_button_click",3,null),f,b=e.derived(()=>t&&f===document.activeElement),o=e.derived(()=>d().map(n=>n[0])),C=e.derived(()=>d().map(n=>n[1])),N=e.derived(()=>c()===void 0||c()===null||Array.isArray(c())&&c().length===0?["",null]:e.get(C).includes(c())?[e.get(o)[e.get(C).indexOf(c())],e.get(C).indexOf(c())]:g()?[c(),null]:["",null]),H=e.derived(()=>e.to_array(e.get(N),2)),p=e.derived(()=>e.get(H)[0]),v=e.derived(()=>e.get(H)[1]),U=e.get(p),W=e.state(!1),J=e.derived(()=>!I()),S=e.state(e.proxy(d().map((n,D)=>D))),E=e.state(null);function j(n){if(e.set(v,parseInt(n.detail.target.dataset.index)),isNaN(e.get(v))){e.set(v,null);return}let[D,B]=d()[e.get(v)];e.set(p,D),U=e.get(p),c(B),l.on_select?.({index:e.get(v),value:e.get(C)[e.get(v)],selected:!0}),e.set(b,!1),e.set(E,null),l.on_input?.(),f.blur()}function K(n){e.set(S,d().map((D,B)=>B),!0),e.set(b,!0),l.on_focus?.()}function Q(){g()?e.get(o).includes(e.get(p))?(e.set(v,e.get(o).indexOf(e.get(p))),c(e.get(C)[e.get(v)])):e.get(p)!==U&&(c(e.get(p)),e.set(v,null)):e.set(p,e.get(o)[e.get(C).indexOf(c())]),e.set(b,!1),e.set(E,null),e.set(S,d().map((n,D)=>D),!0),l.on_blur?.(),l.on_input?.()}async function Z(n){await _e(),e.set(S,ne(d(),e.get(p)),!0),e.set(E,e.get(S).length>0?e.get(S)[0]:null,!0),(D=>{var B=e.to_array(D,2);e.set(b,B[0]),e.set(E,B[1],!0)})(oe(n,e.get(E),e.get(S))),n.key==="Enter"&&(U=e.get(p),e.get(E)!==null?(e.set(v,e.get(E)),c(e.get(C)[e.get(E)]),e.set(b,!1),f.blur(),e.set(E,null)):e.get(o).includes(e.get(p))?(e.set(v,e.get(o).indexOf(e.get(p))),c(e.get(C)[e.get(v)]),e.set(b,!1),e.set(E,null),f.blur()):g()&&(c(e.get(p)),e.set(v,null),e.set(b,!1),e.set(E,null),f.blur()))}let V=e.state(e.proxy(c()));e.user_effect(()=>{e.get(V)!==c()&&(e.set(V,c(),!0),l.on_change?.(c()))});var a=Be();let h;var z=e.child(a);{var M=n=>{le(n,{get buttons(){return m()},get on_custom_button_click(){return G()}})};e.if(z,n=>{O()&&m()&&m().length>0&&n(M)})}var w=e.sibling(z,2);re(w,{get show_label(){return O()},get info(){return u()},children:(n,D)=>{e.next();var B=e.text();e.template_effect(()=>e.set_text(B,s())),e.append(n,B)},$$slots:{default:!0}});var _=e.sibling(w,2),L=e.child(_);let X;var Y=e.child(L),y=e.child(Y);e.remove_input_defaults(y);let r;e.bind_this(y,n=>f=n,()=>f);var i=e.sibling(y,2);{var k=n=>{var D=De(),B=e.child(D);se(B),e.reset(D),e.append(n,D)};e.if(i,n=>{e.get(J)||n(k)})}e.reset(Y),e.reset(L);var q=e.sibling(L,2);{let n=e.derived(()=>e.get(v)===null?[]:[e.get(v)]);ae(q,{get show_options(){return e.get(b)},get choices(){return d()},get filtered_indices(){return e.get(S)},get disabled(){return e.get(J)},get selected_indices(){return e.get(n)},get active_index(){return e.get(E)},$$events:{change:j,load:()=>e.set(W,!0)}})}e.reset(_),e.reset(a),e.template_effect(n=>{h=e.set_class(a,1,"svelte-1xfsv4t",null,h,{container:R()}),X=e.set_class(L,1,"wrap-inner svelte-1xfsv4t",null,X,{show_options:e.get(b)}),e.set_attribute(y,"aria-expanded",e.get(b)),e.set_attribute(y,"aria-label",s()),r=e.set_class(y,1,"border-none svelte-1xfsv4t",null,r,n),y.disabled=e.get(J),y.readOnly=!A()},[()=>({subdued:!e.get(o).includes(e.get(p))&&!g()})]),e.bind_value(y,()=>e.get(p),n=>e.set(p,n)),e.event("keydown",y,Z),e.event("keyup",y,n=>{l.on_key_up?.({key:n.key,input_value:e.get(p)})}),e.event("blur",y,Q),e.event("focus",y,K),e.append(x,a),e.pop()}var Oe=e.from_html("<!> <!>",1);function Ze(x,l){e.push(l,!0);let t=e.rest_props(l,["$$slots","$$events","$$legacy"]);const s=new ue(t);ce(x,{get visible(){return s.shared.visible},get elem_id(){return s.shared.elem_id},get elem_classes(){return s.shared.elem_classes},get padding(){return s.shared.container},allow_overflow:!1,get scale(){return s.shared.scale},get min_width(){return s.shared.min_width},children:(u,c)=>{var d=Oe(),I=e.first_child(d);ge(I,e.spread_props({get autoscroll(){return s.shared.autoscroll},get i18n(){return s.i18n}},()=>s.shared.loading_status,{on_clear_status:()=>s.dispatch("clear_status",loading_status)}));var O=e.sibling(I,2);{var R=A=>{Ae(A,{get gradio(){return s}})},g=A=>{Ee(A,{get label(){return s.shared.label},get info(){return s.props.info},get choices(){return s.props.choices},get interactive(){return s.shared.interactive},get show_label(){return s.shared.show_label},get container(){return s.shared.container},get allow_custom_value(){return s.props.allow_custom_value},get filterable(){return s.props.filterable},get buttons(){return s.props.buttons},on_custom_button_click:m=>{s.dispatch("custom_button_click",{id:m})},on_change:()=>s.dispatch("change"),on_input:()=>s.dispatch("input"),on_select:m=>s.dispatch("select",m),on_focus:()=>s.dispatch("focus"),on_blur:()=>s.dispatch("blur"),on_key_up:m=>s.dispatch("key_up",m),get value(){return s.props.value},set value(m){s.props.value=m}})};e.if(O,A=>{s.props.multiselect?A(R):A(g,!1)})}e.append(u,d)},$$slots:{default:!0}}),e.pop()}export{Ee as BaseDropdown,ae as BaseDropdownOptions,tt as BaseExample,Ae as BaseMultiselect,Ze as default};
